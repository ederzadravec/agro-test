FROM node:20
WORKDIR /api
COPY . .
RUN yarn 
RUN yarn build
RUN yarn install --production

ENV _TZ $TZ
ENV _APP_KEY $APP_KEY
ENV _HOST $HOST
ENV _PORT $PORT
ENV _LOG_LEVEL $LOG_LEVEL
ENV _NODE_ENV $NODE_ENV

ENV _DB_HOST $DB_HOST
ENV _DB_PORT $DB_PORT
ENV _DB_USER $DB_USER
ENV _DB_PASSWORD $DB_PASSWORD
ENV _DB_DATABASE $DB_DATABASE

EXPOSE 8080
CMD ["yarn","start"]
